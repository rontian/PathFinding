var PF,__reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();!function(t){!function(t){t[t.Always=1]="Always",t[t.Never=2]="Never",t[t.IfAtMostOneObstacle=3]="IfAtMostOneObstacle",t[t.OnlyWhenNoObstacles=4]="OnlyWhenNoObstacles"}(t.DiagonalMovement||(t.DiagonalMovement={}))}(PF||(PF={})),function(t){var e=function(){function e(t,e,n){var i;"object"!=typeof t?i=t:(e=t.length,i=t[0].length,n=t),this.$width=i,this.$height=e,this.$nodes=this.buildNodes(i,e,n)}return e.prototype.buildNodes=function(e,n,i){var o,r,a=new Array(n);for(o=0;o<n;++o)for(a[o]=new Array(e),r=0;r<e;++r)a[o][r]=new t.Node(r,o);if(void 0===i)return a;if(i.length!==n||i[0].length!==e)throw new Error("Matrix size does not fit");for(o=0;o<n;++o)for(r=0;r<e;++r)i[o][r]&&(a[o][r].walkable=!1);return a},e.prototype.getNodeAt=function(t,e){return this.$nodes[e][t]},e.prototype.isWalkableAt=function(t,e){return this.isInside(t,e)&&this.$nodes[e][t].walkable},e.prototype.isInside=function(t,e){return t>=0&&t<this.width&&e>=0&&e<this.height},e.prototype.setWalkableAt=function(t,e,n){this.isInside(t,e)&&(this.$nodes[e][t].walkable=n)},e.prototype.getNeighbors=function(e,n){var i=e.x,o=e.y,r=[],a=!1,s=!1,l=!1,u=!1,h=!1,p=!1,c=!1,f=!1,d=this.$nodes;if(this.isWalkableAt(i,o-1)&&(r.push(d[o-1][i]),a=!0),this.isWalkableAt(i+1,o)&&(r.push(d[o][i+1]),l=!0),this.isWalkableAt(i,o+1)&&(r.push(d[o+1][i]),h=!0),this.isWalkableAt(i-1,o)&&(r.push(d[o][i-1]),c=!0),n===t.DiagonalMovement.Never)return r;if(n===t.DiagonalMovement.OnlyWhenNoObstacles)s=c&&a,u=a&&l,p=l&&h,f=h&&c;else if(n===t.DiagonalMovement.IfAtMostOneObstacle)s=c||a,u=a||l,p=l||h,f=h||c;else{if(n!==t.DiagonalMovement.Always)throw new Error("Incorrect value of diagonalMovement");s=!0,u=!0,p=!0,f=!0}return s&&this.isWalkableAt(i-1,o-1)&&r.push(d[o-1][i-1]),u&&this.isWalkableAt(i+1,o-1)&&r.push(d[o-1][i+1]),p&&this.isWalkableAt(i+1,o+1)&&r.push(d[o+1][i+1]),f&&this.isWalkableAt(i-1,o+1)&&r.push(d[o+1][i-1]),r},e.prototype.clone=function(){var t,n,i=this.width,o=this.height,r=this.$nodes,a=new e(i,o);for(t=0;t<o;++t)for(n=0;n<i;++n)a.$nodes[t][n].walkable=r[t][n].walkable;return a},Object.defineProperty(e.prototype,"values",{get:function(){for(var t=[],e=0;e<this.height;e++){for(var n=t[e]||[],i=0;i<this.width;i++)n[i]=this.isWalkableAt(i,e)?0:1;t[e]=n}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.$width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.$height},enumerable:!0,configurable:!0}),e}();t.Grid=e,__reflect(e.prototype,"PF.Grid")}(PF||(PF={})),function(t){var e=function(){function t(t){this.$compare=t||n,this.$nodes=[]}return t.prototype.push=function(e){return t.push(this.$nodes,e,this.$compare)},t.prototype.pop=function(){return t.pop(this.$nodes,this.$compare)},t.prototype.peek=function(){return this.$nodes[0]},t.prototype.contains=function(t){return-1!==this.$nodes.indexOf(t)},t.prototype.replace=function(e){return t.replace(this.$nodes,e,this.$compare)},t.prototype.pushpop=function(e){return t.pushpop(this.$nodes,e,this.$compare)},t.prototype.ify=function(){return t.ify(this.$nodes,this.$compare)},t.prototype.updateItem=function(e){return t.updateItem(this.$nodes,e,this.$compare)},t.prototype.clear=function(){this.$nodes.length=0},t.prototype.empty=function(){return 0===this.$nodes.length},t.prototype.size=function(){return this.$nodes.length},t.prototype.clone=function(){var e=new t(this.$compare);return e.$nodes=this.$nodes.slice(0),e},t.prototype.toArray=function(){return this.$nodes.slice(0)},t.push=function(t,e,o){return null==o&&(o=n),t.push(e),i(t,0,t.length-1,o)},t.pop=function(t,e){var i,r;return null==e&&(e=n),i=t.pop(),t.length?(r=t[0],t[0]=i,o(t,0,e)):r=i,r},t.replace=function(t,e,i){var r;return null==i&&(i=n),r=t[0],t[0]=e,o(t,0,i),r},t.pushpop=function(t,e,i){var r;return null==i&&(i=n),t.length&&i(t[0],e)<0&&(e=(r=[t[0],e])[0],t[0]=r[1],o(t,0,i)),e},t.ify=function(t,e){var i,r,a,s,l,u;for(null==e&&(e=n),l=[],r=0,a=(s=function(){u=[];for(var e=0,n=Math.floor(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)u.push(e);return u}.apply(this).reverse()).length;r<a;r++)i=s[r],l.push(o(t,i,e));return l},t.updateItem=function(t,e,r){var a;if(null==r&&(r=n),-1!==(a=t.indexOf(e)))return i(t,0,a,r),o(t,a,r)},t.nlargest=function(t,e,i){var o,r,a,s,l;if(null==i&&(i=n),!(r=t.slice(0,e)).length)return r;for(this.ify(r,i),a=0,s=(l=t.slice(e)).length;a<s;a++)o=l[a],this.pushpop(r,o,i);return r.sort(i).reverse()},t.nsmallest=function(t,e,i){var o,a,s,l,u,h,p,c,f;if(null==i&&(i=n),10*e<=t.length){if(!(s=t.slice(0,e).sort(i)).length)return s;for(a=s[s.length-1],l=0,h=(p=t.slice(e)).length;l<h;l++)i(o=p[l],a)<0&&(r(s,o,0,null,i),s.pop(),a=s[s.length-1]);return s}for(this.ify(t,i),f=[],l=u=0,c=Math.min(e,t.length);0<=c?u<c:u>c;l=0<=c?++u:--u)f.push(this.pop(t,i));return f},t}();function n(t,e){return t<e?-1:t>e?1:0}function i(t,e,i,o){var r,a,s;for(null==o&&(o=n),r=t[i];i>e&&o(r,a=t[s=i-1>>1])<0;)t[i]=a,i=s;return t[i]=r}function o(t,e,o){var r,a,s,l,u;for(null==o&&(o=n),a=t.length,u=e,s=t[e],r=2*e+1;r<a;)(l=r+1)<a&&!(o(t[r],t[l])<0)&&(r=l),t[e]=t[r],r=2*(e=r)+1;return t[e]=s,i(t,u,e,o)}function r(t,e,i,o,r){var a;if(null==i&&(i=0),null==r&&(r=n),i<0)throw new Error("lo must be non-negative");for(null==o&&(o=t.length);i<o;)r(e,t[a=Math.floor((i+o)/2)])<0?o=a:i=a+1;return[].splice.apply(t,[i,i-i].concat(e)),e}t.Heap=e,__reflect(e.prototype,"PF.Heap")}(PF||(PF={})),function(t){var e=function(){function t(){}return t.manhattan=function(t,e){return t+e},t.euclidean=function(t,e){return Math.sqrt(t*t+e*e)},t.octile=function(t,e){var n=Math.SQRT2-1;return t<e?n*t+e:n*e+t},t.chebyshev=function(t,e){return Math.max(t,e)},t}();t.Heuristic=e,__reflect(e.prototype,"PF.Heuristic")}(PF||(PF={})),function(t){var e=function(){return function(t,e,n){void 0===n&&(n=!0),this.f=0,this.g=0,this.h=0,this.x=t,this.y=e,this.walkable=n}}();t.Node=e,__reflect(e.prototype,"PF.Node")}(PF||(PF={})),function(t){var e=function(){function t(){}return t.backtrace=function(t){for(var e=[[t.x,t.y]];t.parent;)t=t.parent,e.push([t.x,t.y]);return e.reverse()},t.biBacktrace=function(t,e){var n=this.backtrace(t),i=this.backtrace(e);return n.concat(i.reverse())},t.pathLength=function(t){var e,n,i,o,r,a=0;for(e=1;e<t.length;++e)n=t[e-1],i=t[e],o=n[0]-i[0],r=n[1]-i[1],a+=Math.sqrt(o*o+r*r);return a},t.expandPath=function(t){var e,n,i,o,r,a,s=[],l=t.length;if(l<2)return s;for(r=0;r<l-1;++r)for(e=t[r],n=t[r+1],o=(i=this.interpolate(e[0],e[1],n[0],n[1])).length,a=0;a<o-1;++a)s.push(i[a]);return s.push(t[l-1]),s},t.interpolate=function(t,e,n,i){var o,r,a,s,l,u,h=Math.abs,p=[];for(o=t<n?1:-1,r=e<i?1:-1,l=(a=h(n-t))-(s=h(i-e));p.push([t,e]),t!==n||e!==i;)(u=2*l)>-s&&(l-=s,t+=o),u<a&&(l+=a,e+=r);return p},t}();t.Util=e,__reflect(e.prototype,"PF.Util")}(PF||(PF={})),function(t){var e=function(){function e(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.heuristic=e.heuristic||t.Heuristic.manhattan,this.weight=e.weight||1,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=t.DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=t.DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=t.DiagonalMovement.Never),this.diagonalMovement===t.DiagonalMovement.Never?this.heuristic=e.heuristic||t.Heuristic.manhattan:this.heuristic=e.heuristic||t.Heuristic.octile}return e.prototype.findPath=function(e,n,i,o,r){var a,s,l,u,h,p,c,f,d=new t.Heap(function(t,e){return t.f-e.f}),g=r.getNodeAt(e,n),b=r.getNodeAt(i,o),v=this.heuristic,m=this.diagonalMovement,A=this.weight,y=Math.abs,k=Math.SQRT2;for(g.g=0,g.f=0,d.push(g),g.opened=!0;!d.empty();){if((a=d.pop()).closed=!0,a===b)return t.Util.backtrace(b);for(u=0,h=(s=r.getNeighbors(a,m)).length;u<h;++u)(l=s[u]).closed||(p=l.x,c=l.y,f=a.g+(p-a.x==0||c-a.y==0?1:k),(!l.opened||f<l.g)&&(l.g=f,l.h=l.h||A*v(y(p-i),y(c-o)),l.f=l.g+l.h,l.parent=a,l.opened?d.updateItem(l):(d.push(l),l.opened=!0)))}return[]},e}();t.AStarFinder=e,__reflect(e.prototype,"PF.AStarFinder")}(PF||(PF={})),function(t){var e=function(t){function e(e){var n=t.call(this,e)||this,i=n.heuristic;return n.heuristic=function(t,e){return 1e6*i(t,e)},n}return __extends(e,t),e}(t.AStarFinder);t.BestFirstFinder=e,__reflect(e.prototype,"PF.BestFirstFinder")}(PF||(PF={})),function(t){var e=function(){function e(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||t.Heuristic.manhattan,this.weight=e.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=t.DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=t.DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=t.DiagonalMovement.Never),this.diagonalMovement===t.DiagonalMovement.Never?this.heuristic=e.heuristic||t.Heuristic.manhattan:this.heuristic=e.heuristic||t.Heuristic.octile}return e.prototype.findPath=function(e,n,i,o,r){var a,s,l,u,h,p,c,f,d=function(t,e){return t.f-e.f},g=new t.Heap(d),b=new t.Heap(d),v=r.getNodeAt(e,n),m=r.getNodeAt(i,o),A=this.heuristic,y=this.diagonalMovement,k=this.weight,M=Math.abs,F=Math.SQRT2;for(v.g=0,v.f=0,g.push(v),v.opened=1,m.g=0,m.f=0,b.push(m),m.opened=2;!g.empty()&&!b.empty();){for((a=g.pop()).closed=!0,u=0,h=(s=r.getNeighbors(a,y)).length;u<h;++u)if(!(l=s[u]).closed){if(2===l.opened)return t.Util.biBacktrace(a,l);p=l.x,c=l.y,f=a.g+(p-a.x==0||c-a.y==0?1:F),(!l.opened||f<l.g)&&(l.g=f,l.h=l.h||k*A(M(p-i),M(c-o)),l.f=l.g+l.h,l.parent=a,l.opened?g.updateItem(l):(g.push(l),l.opened=1))}for((a=b.pop()).closed=!0,u=0,h=(s=r.getNeighbors(a,y)).length;u<h;++u)if(!(l=s[u]).closed){if(1===l.opened)return t.Util.biBacktrace(l,a);p=l.x,c=l.y,f=a.g+(p-a.x==0||c-a.y==0?1:F),(!l.opened||f<l.g)&&(l.g=f,l.h=l.h||k*A(M(p-e),M(c-n)),l.f=l.g+l.h,l.parent=a,l.opened?b.updateItem(l):(b.push(l),l.opened=2))}}return[]},e}();t.BiAStarFinder=e,__reflect(e.prototype,"PF.BiAStarFinder")}(PF||(PF={})),function(t){var e=function(t){function e(e){var n=t.call(this,e)||this,i=n.heuristic;return n.heuristic=function(t,e){return 1e6*i(t,e)},n}return __extends(e,t),e}(t.BiAStarFinder);t.BiBestFirstFinder=e,__reflect(e.prototype,"PF.BiBestFirstFinder")}(PF||(PF={})),function(t){var e=function(){function e(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=t.DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=t.DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=t.DiagonalMovement.Never)}return e.prototype.findPath=function(e,n,i,o,r){var a,s,l,u,h,p=r.getNodeAt(e,n),c=r.getNodeAt(i,o),f=[],d=[],g=this.diagonalMovement;for(f.push(p),p.opened=!0,p.by=0,d.push(c),c.opened=!0,c.by=1;f.length&&d.length;){for((l=f.shift()).closed=!0,u=0,h=(a=r.getNeighbors(l,g)).length;u<h;++u)if(!(s=a[u]).closed)if(s.opened){if(1===s.by)return t.Util.biBacktrace(l,s)}else f.push(s),s.parent=l,s.opened=!0,s.by=0;for((l=d.shift()).closed=!0,u=0,h=(a=r.getNeighbors(l,g)).length;u<h;++u)if(!(s=a[u]).closed)if(s.opened){if(0===s.by)return t.Util.biBacktrace(s,l)}else d.push(s),s.parent=l,s.opened=!0,s.by=1}return[]},e}();t.BiBreadthFirstFinder=e,__reflect(e.prototype,"PF.BiBreadthFirstFinder")}(PF||(PF={})),function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.heuristic=function(t,e){return 0},n}return __extends(e,t),e}(t.BiAStarFinder);t.BiDijkstraFinder=e,__reflect(e.prototype,"PF.BiDijkstraFinder")}(PF||(PF={})),function(t){var e=function(){function e(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=t.DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=t.DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=t.DiagonalMovement.Never)}return e.prototype.findPath=function(e,n,i,o,r){var a,s,l,u,h,p=[],c=this.diagonalMovement,f=r.getNodeAt(e,n),d=r.getNodeAt(i,o);for(p.push(f),f.opened=!0;p.length;){if((l=p.shift()).closed=!0,l===d)return t.Util.backtrace(d);for(u=0,h=(a=r.getNeighbors(l,c)).length;u<h;++u)(s=a[u]).closed||s.opened||(p.push(s),s.opened=!0,s.parent=l)}return[]},e}();t.BreadthFirstFinder=e,__reflect(e.prototype,"PF.BreadthFirstFinder")}(PF||(PF={})),function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.heuristic=function(t,e){return 0},n}return __extends(e,t),e}(t.AStarFinder);t.DijkstraFinder=e,__reflect(e.prototype,"PF.DijkstraFinder")}(PF||(PF={})),function(t){var e=function(){function e(e){e=e||{},this.allowDiagonal=e.allowDiagonal,this.dontCrossCorners=e.dontCrossCorners,this.diagonalMovement=e.diagonalMovement,this.heuristic=e.heuristic||t.Heuristic.manhattan,this.weight=e.weight||1,this.trackRecursion=e.trackRecursion||!1,this.timeLimit=e.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=t.DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=t.DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=t.DiagonalMovement.Never),this.diagonalMovement===t.DiagonalMovement.Never?this.heuristic=e.heuristic||t.Heuristic.manhattan:this.heuristic=e.heuristic||t.Heuristic.octile}return e.prototype.findPath=function(e,n,i,o,r){var a,s,l=this,u=(new Date).getTime(),h=function(t,e){return l.heuristic(Math.abs(e.x-t.x),Math.abs(e.y-t.y))},p=function(e,n,i,o,a){if(0,l.timeLimit>0&&(new Date).getTime()-u>1e3*l.timeLimit)return 1/0;var s,c,d,g,b=n+h(e,f)*l.weight;if(b>i)return b;if(e==f)return o[a]=[e.x,e.y],e;var v,m,A=r.getNeighbors(e,l.diagonalMovement);for(d=0,s=1/0;g=A[d];++d){if(l.trackRecursion&&(g.retainCount=g.retainCount+1||1,!0!==g.tested&&(g.tested=!0)),(c=p(g,n+(m=g,(v=e).x===m.x||v.y===m.y?1:Math.SQRT2),i,o,a+1))instanceof t.Node)return o[a]=[e.x,e.y],c;l.trackRecursion&&0==--g.retainCount&&(g.tested=!1),c<s&&(s=c)}return s},c=r.getNodeAt(e,n),f=r.getNodeAt(i,o),d=h(c,f),g=[];for(a=0;;++a){if((s=p(c,0,d,g=[],0))===1/0)return[];if(s instanceof t.Node)return g;d=s}},e}();t.IDAStarFinder=e,__reflect(e.prototype,"PF.IDAStarFinder")}(PF||(PF={})),function(t){var e=function(){function e(e){e=e||{},this.heuristic=e.heuristic||t.Heuristic.manhattan,this.trackJumpRecursion=e.trackJumpRecursion||!1}return e.prototype.findPath=function(e,n,i,o,r){var a,s=this.openList=new t.Heap(function(t,e){return t.f-e.f}),l=this.startNode=r.getNodeAt(e,n),u=this.endNode=r.getNodeAt(i,o);for(this.grid=r,l.g=0,l.f=0,s.push(l),l.opened=!0;!s.empty();){if((a=s.pop()).closed=!0,a===u)return t.Util.expandPath(t.Util.backtrace(u));this._identifySuccessors(a)}return[]},e.prototype._identifySuccessors=function(e){var n,i,o,r,a,s,l,u,h,p,c=this.grid,f=this.heuristic,d=this.openList,g=this.endNode.x,b=this.endNode.y,v=e.x,m=e.y,A=Math.abs;Math.max;for(r=0,a=(n=this._findNeighbors(e)).length;r<a;++r)if(i=n[r],o=this._jump(i[0],i[1],v,m)){if(s=o[0],l=o[1],(p=c.getNodeAt(s,l)).closed)continue;u=t.Heuristic.octile(A(s-v),A(l-m)),h=e.g+u,(!p.opened||h<p.g)&&(p.g=h,p.h=p.h||f(A(s-g),A(l-b)),p.f=p.g+p.h,p.parent=e,p.opened?d.updateItem(p):(d.push(p),p.opened=!0))}},e}();t.JumpPointFinderBase=e,__reflect(e.prototype,"PF.JumpPointFinderBase")}(PF||(PF={})),function(t){var e=function(e){function n(t){return e.call(this,t)||this}return __extends(n,e),n.prototype._jump=function(t,e,n,i){var o=this.grid,r=t-n,a=e-i;if(!o.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(t,e).tested=!0),o.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r&&0!==a){if(o.isWalkableAt(t-r,e+a)&&!o.isWalkableAt(t-r,e)||o.isWalkableAt(t+r,e-a)&&!o.isWalkableAt(t,e-a))return[t,e];if(this._jump(t+r,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==r){if(o.isWalkableAt(t+r,e+1)&&!o.isWalkableAt(t,e+1)||o.isWalkableAt(t+r,e-1)&&!o.isWalkableAt(t,e-1))return[t,e]}else if(o.isWalkableAt(t+1,e+a)&&!o.isWalkableAt(t+1,e)||o.isWalkableAt(t-1,e+a)&&!o.isWalkableAt(t-1,e))return[t,e];return this._jump(t+r,e+a,t,e)},n.prototype._findNeighbors=function(e){var n,i,o,r,a,s,l,u,h=e.parent,p=e.x,c=e.y,f=this.grid,d=[];if(h)n=h.x,i=h.y,o=(p-n)/Math.max(Math.abs(p-n),1),r=(c-i)/Math.max(Math.abs(c-i),1),0!==o&&0!==r?(f.isWalkableAt(p,c+r)&&d.push([p,c+r]),f.isWalkableAt(p+o,c)&&d.push([p+o,c]),f.isWalkableAt(p+o,c+r)&&d.push([p+o,c+r]),f.isWalkableAt(p-o,c)||d.push([p-o,c+r]),f.isWalkableAt(p,c-r)||d.push([p+o,c-r])):0===o?(f.isWalkableAt(p,c+r)&&d.push([p,c+r]),f.isWalkableAt(p+1,c)||d.push([p+1,c+r]),f.isWalkableAt(p-1,c)||d.push([p-1,c+r])):(f.isWalkableAt(p+o,c)&&d.push([p+o,c]),f.isWalkableAt(p,c+1)||d.push([p+o,c+1]),f.isWalkableAt(p,c-1)||d.push([p+o,c-1]));else for(l=0,u=(a=f.getNeighbors(e,t.DiagonalMovement.Always)).length;l<u;++l)s=a[l],d.push([s.x,s.y]);return d},n}(t.JumpPointFinderBase);t.JPFAlwaysMoveDiagonally=e,__reflect(e.prototype,"PF.JPFAlwaysMoveDiagonally")}(PF||(PF={})),function(t){var e=function(e){function n(t){return e.call(this,t)||this}return __extends(n,e),n.prototype._jump=function(t,e,n,i){var o=this.grid,r=t-n,a=e-i;if(!o.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(t,e).tested=!0),o.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r&&0!==a){if(o.isWalkableAt(t-r,e+a)&&!o.isWalkableAt(t-r,e)||o.isWalkableAt(t+r,e-a)&&!o.isWalkableAt(t,e-a))return[t,e];if(this._jump(t+r,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==r){if(o.isWalkableAt(t+r,e+1)&&!o.isWalkableAt(t,e+1)||o.isWalkableAt(t+r,e-1)&&!o.isWalkableAt(t,e-1))return[t,e]}else if(o.isWalkableAt(t+1,e+a)&&!o.isWalkableAt(t+1,e)||o.isWalkableAt(t-1,e+a)&&!o.isWalkableAt(t-1,e))return[t,e];return o.isWalkableAt(t+r,e)||o.isWalkableAt(t,e+a)?this._jump(t+r,e+a,t,e):null},n.prototype._findNeighbors=function(e){var n,i,o,r,a,s,l,u,h=e.parent,p=e.x,c=e.y,f=this.grid,d=[];if(h)n=h.x,i=h.y,o=(p-n)/Math.max(Math.abs(p-n),1),r=(c-i)/Math.max(Math.abs(c-i),1),0!==o&&0!==r?(f.isWalkableAt(p,c+r)&&d.push([p,c+r]),f.isWalkableAt(p+o,c)&&d.push([p+o,c]),(f.isWalkableAt(p,c+r)||f.isWalkableAt(p+o,c))&&d.push([p+o,c+r]),!f.isWalkableAt(p-o,c)&&f.isWalkableAt(p,c+r)&&d.push([p-o,c+r]),!f.isWalkableAt(p,c-r)&&f.isWalkableAt(p+o,c)&&d.push([p+o,c-r])):0===o?f.isWalkableAt(p,c+r)&&(d.push([p,c+r]),f.isWalkableAt(p+1,c)||d.push([p+1,c+r]),f.isWalkableAt(p-1,c)||d.push([p-1,c+r])):f.isWalkableAt(p+o,c)&&(d.push([p+o,c]),f.isWalkableAt(p,c+1)||d.push([p+o,c+1]),f.isWalkableAt(p,c-1)||d.push([p+o,c-1]));else for(l=0,u=(a=f.getNeighbors(e,t.DiagonalMovement.IfAtMostOneObstacle)).length;l<u;++l)s=a[l],d.push([s.x,s.y]);return d},n}(t.JumpPointFinderBase);t.JPFMoveDiagonallyIfAtMostOneObstacle=e,__reflect(e.prototype,"PF.JPFMoveDiagonallyIfAtMostOneObstacle")}(PF||(PF={})),function(t){var e=function(e){function n(t){return e.call(this,t)||this}return __extends(n,e),n.prototype._jump=function(t,e,n,i){var o=this.grid,r=t-n,a=e-i;if(!o.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(t,e).tested=!0),o.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r&&0!==a){if(this._jump(t+r,e,t,e)||this._jump(t,e+a,t,e))return[t,e]}else if(0!==r){if(o.isWalkableAt(t,e-1)&&!o.isWalkableAt(t-r,e-1)||o.isWalkableAt(t,e+1)&&!o.isWalkableAt(t-r,e+1))return[t,e]}else if(0!==a&&(o.isWalkableAt(t-1,e)&&!o.isWalkableAt(t-1,e-a)||o.isWalkableAt(t+1,e)&&!o.isWalkableAt(t+1,e-a)))return[t,e];return o.isWalkableAt(t+r,e)&&o.isWalkableAt(t,e+a)?this._jump(t+r,e+a,t,e):null},n.prototype._findNeighbors=function(e){var n,i,o,r,a,s,l,u,h,p=e.parent,c=e.x,f=e.y,d=this.grid,g=[];if(p){if(n=p.x,i=p.y,o=(c-n)/Math.max(Math.abs(c-n),1),r=(f-i)/Math.max(Math.abs(f-i),1),0!==o&&0!==r)d.isWalkableAt(c,f+r)&&g.push([c,f+r]),d.isWalkableAt(c+o,f)&&g.push([c+o,f]),d.isWalkableAt(c,f+r)&&d.isWalkableAt(c+o,f)&&g.push([c+o,f+r]);else if(0!==o){h=d.isWalkableAt(c+o,f);var b=d.isWalkableAt(c,f+1),v=d.isWalkableAt(c,f-1);h&&(g.push([c+o,f]),b&&g.push([c+o,f+1]),v&&g.push([c+o,f-1])),b&&g.push([c,f+1]),v&&g.push([c,f-1])}else if(0!==r){h=d.isWalkableAt(c,f+r);var m=d.isWalkableAt(c+1,f),A=d.isWalkableAt(c-1,f);h&&(g.push([c,f+r]),m&&g.push([c+1,f+r]),A&&g.push([c-1,f+r])),m&&g.push([c+1,f]),A&&g.push([c-1,f])}}else for(l=0,u=(a=d.getNeighbors(e,t.DiagonalMovement.OnlyWhenNoObstacles)).length;l<u;++l)s=a[l],g.push([s.x,s.y]);return g},n}(t.JumpPointFinderBase);t.JPFMoveDiagonallyIfNoObstacles=e,__reflect(e.prototype,"PF.JPFMoveDiagonallyIfNoObstacles")}(PF||(PF={})),function(t){var e=function(e){function n(t){return e.call(this,t)||this}return __extends(n,e),n.prototype._jump=function(t,e,n,i){var o=this.grid,r=t-n,a=e-i;if(!o.isWalkableAt(t,e))return null;if(!0===this.trackJumpRecursion&&(o.getNodeAt(t,e).tested=!0),o.getNodeAt(t,e)===this.endNode)return[t,e];if(0!==r){if(o.isWalkableAt(t,e-1)&&!o.isWalkableAt(t-r,e-1)||o.isWalkableAt(t,e+1)&&!o.isWalkableAt(t-r,e+1))return[t,e]}else{if(0===a)throw new Error("Only horizontal and vertical movements are allowed");if(o.isWalkableAt(t-1,e)&&!o.isWalkableAt(t-1,e-a)||o.isWalkableAt(t+1,e)&&!o.isWalkableAt(t+1,e-a))return[t,e];if(this._jump(t+1,e,t,e)||this._jump(t-1,e,t,e))return[t,e]}return this._jump(t+r,e+a,t,e)},n.prototype._findNeighbors=function(e){var n,i,o,r,a,s,l,u,h=e.parent,p=e.x,c=e.y,f=this.grid,d=[];if(h)n=h.x,i=h.y,o=(p-n)/Math.max(Math.abs(p-n),1),r=(c-i)/Math.max(Math.abs(c-i),1),0!==o?(f.isWalkableAt(p,c-1)&&d.push([p,c-1]),f.isWalkableAt(p,c+1)&&d.push([p,c+1]),f.isWalkableAt(p+o,c)&&d.push([p+o,c])):0!==r&&(f.isWalkableAt(p-1,c)&&d.push([p-1,c]),f.isWalkableAt(p+1,c)&&d.push([p+1,c]),f.isWalkableAt(p,c+r)&&d.push([p,c+r]));else for(l=0,u=(a=f.getNeighbors(e,t.DiagonalMovement.Never)).length;l<u;++l)s=a[l],d.push([s.x,s.y]);return d},n}(t.JumpPointFinderBase);t.JPFNeverMoveDiagonally=e,__reflect(e.prototype,"PF.JPFNeverMoveDiagonally")}(PF||(PF={})),function(t){t.JumpPointFinder=function(e){return(e=e||{}).diagonalMovement===t.DiagonalMovement.Never?new t.JPFNeverMoveDiagonally(e):e.diagonalMovement===t.DiagonalMovement.Always?new t.JPFAlwaysMoveDiagonally(e):e.diagonalMovement===t.DiagonalMovement.OnlyWhenNoObstacles?new t.JPFMoveDiagonallyIfNoObstacles(e):new t.JPFMoveDiagonallyIfAtMostOneObstacle(e)}}(PF||(PF={}));